(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d826c96"],{"2d6a":function(e,t,a){},"95ef":function(e,t,a){"use strict";var n=a("2d6a"),s=a.n(n);s.a},b721:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",[a("div",{staticClass:"jumbotron"},[a("h1",{attrs:{align:"center"}},[e._v("Chat with "+e._s(e.chatWith))]),a("div",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll"}],staticClass:"my-3 p-3 bg-white rounded shadow-sm scroll"},[a("div",{staticClass:"media text pt-3"},[a("div",e._l(e.messages,(function(t){return a("div",{key:t.id,staticClass:"media-body pb-3 mb-0 lh-125"},[a("span",[e._v(e._s(t.value))]),a("span",{staticClass:"text-muted"},[e._v(e._s(t.sender)+", "+e._s(e.makeTimeReadable(t.timestamp)))]),e.user.uname==t.sender?a("a",{staticClass:"btn text-right text-muted",on:{click:function(a){return a.preventDefault(),e.delChat(t.value,t.sender,t.timestamp)}}},[e._v("Delete")]):e._e()])})),0)])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("form",[a("div",{staticClass:"input-group add-on"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],staticClass:"form-control mr-1",attrs:{type:"text",id:"newMessage",placeholder:"Send a message..."},domProps:{value:e.newMessage},on:{input:[function(t){t.target.composing||(e.newMessage=t.target.value)},function(t){return e.checkInput()}]}}),a("div",{staticClass:"input-group-btn"},[a("button",{staticClass:"btn btn-primary",attrs:{disabled:e.disableSend},on:{click:function(t){return t.preventDefault(),e.sendMessage()}}},[e._v(" Send ")])])])])])])]),a("hr",{staticClass:"featurette-divider"}),a("footer",{staticClass:"container"},[e._m(0),a("p",[e._v(" © 2020 BU Spark! · "),a("a",[a("router-link",{attrs:{to:{name:"privacy"}}},[e._v("Privacy")])],1)])])])},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"float-right"},[a("a",{attrs:{href:"#"}},[e._v("Back to top")])])}],r=(a("96cf"),a("1da1")),c=a("c1df"),i=a.n(c),u=a("032d"),o={name:"chat",computed:{user:function(){return this.$store.state.user}},data:function(){return{uname:this.$route.params.uname,chatWith:null,chatID:null,messages:[],newMessage:null,disableSend:null}},methods:{sendMessage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u["d"].httpsCallable("addChat")({chatID:e.chatID,message:{value:e.newMessage,sender:e.user.uname,timestamp:Date.now()}});case 2:e.newMessage=null;case 3:case"end":return t.stop()}}),t)})))()},checkInput:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:null==e.newMessage||""==e.newMessage?e.disableSend=!0:e.disableSend=!1;case 1:case"end":return t.stop()}}),t)})))()},delChat:function(e,t,a){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,u["d"].httpsCallable("deleteChat")({chatID:n.chatID,message:{value:e,sender:t,timestamp:a}});case 2:case"end":return s.stop()}}),s)})))()},makeTimeReadable:function(e){return i()(e).format("lll")}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u["c"].collection("users").where("uname","==",e.uname).get();case 2:if(a=t.sent,!a.empty){t.next=7;break}e.$router.push({name:"allchats"}),t.next=22;break;case 7:return e.chatWith=a.docs[0].data().displayName,n=[e.uname+e.user.uname,e.user.uname+e.uname,e.user.uname,e.uname,e.user.displayName,e.chatWith],t.next=11,u["c"].collection("chats").where("chatRoomID","array-contains",e.user.uname+e.uname).get();case 11:if(s=t.sent,!s.empty){t.next=18;break}return t.next=15,u["d"].httpsCallable("createChatBox")({chatRoomID:n});case 15:location.reload(),t.next=19;break;case 18:e.chatID=s.docs[0].id;case 19:r=u["c"].collection("chats").doc(e.chatID),r.onSnapshot((function(t){e.messages=t.data().messages})),e.disableSend=!0;case 22:case"end":return t.stop()}}),t)})))()}},l=o,d=(a("95ef"),a("2877")),m=Object(d["a"])(l,n,s,!1,null,"98bf031a",null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-6d826c96.71acfeab.js.map