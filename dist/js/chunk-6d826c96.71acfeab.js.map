{"version":3,"sources":["webpack:///./src/components/chat/chat.vue?db13","webpack:///./src/components/chat/chat.vue?40fc","webpack:///src/components/chat/chat.vue","webpack:///./src/components/chat/chat.vue?4be3","webpack:///./src/components/chat/chat.vue?a29d"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","_s","chatWith","directives","name","rawName","_l","message","key","id","value","sender","makeTimeReadable","timestamp","user","uname","on","$event","preventDefault","delChat","_e","expression","domProps","target","composing","newMessage","checkInput","disableSend","sendMessage","_m","staticRenderFns","computed","$store","state","data","$route","params","chatID","messages","methods","component"],"mappings":"2IAAA,yBAAmjB,EAAG,G,yCCAtjB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACA,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,KAAK,CAACG,MAAM,CAAC,MAAQ,WAAW,CAACP,EAAIQ,GAAG,aAAaR,EAAIS,GAAGT,EAAIU,aAAaN,EAAG,MAAM,CAACO,WAAW,CAAC,CAACC,KAAK,cAAcC,QAAQ,kBAAkBP,YAAY,8CAA8C,CAACF,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,MAAMJ,EAAIc,GAAId,EAAY,UAAE,SAASe,GAAS,OAAOX,EAAG,MAAM,CAACY,IAAID,EAAQE,GAAGX,YAAY,+BAA+B,CAACF,EAAG,OAAO,CAACJ,EAAIQ,GAAGR,EAAIS,GAAGM,EAAQG,UAAUd,EAAG,OAAO,CAACE,YAAY,cAAc,CAACN,EAAIQ,GAAGR,EAAIS,GAAGM,EAAQI,QAAQ,KAAKnB,EAAIS,GAAGT,EAAIoB,iBAAiBL,EAAQM,eAAgBrB,EAAIsB,KAAKC,OAASR,EAAQI,OAAQf,EAAG,IAAI,CAACE,YAAY,4BAA4BkB,GAAG,CAAC,MAAQ,SAASC,GAAgC,OAAxBA,EAAOC,iBAAwB1B,EAAI2B,QAAQZ,EAAQG,MAAOH,EAAQI,OAAQJ,EAAQM,cAAc,CAACrB,EAAIQ,GAAG,YAAYR,EAAI4B,UAAS,OAAOxB,EAAG,MAAM,CAACE,YAAY,OAAO,CAACF,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,OAAO,CAACA,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,QAAQ,CAACO,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUK,MAAOlB,EAAc,WAAE6B,WAAW,eAAevB,YAAY,oBAAoBC,MAAM,CAAC,KAAO,OAAO,GAAK,aAAa,YAAc,qBAAqBuB,SAAS,CAAC,MAAS9B,EAAc,YAAGwB,GAAG,CAAC,MAAQ,CAAC,SAASC,GAAWA,EAAOM,OAAOC,YAAqBhC,EAAIiC,WAAWR,EAAOM,OAAOb,QAAO,SAASO,GAAQ,OAAOzB,EAAIkC,kBAAkB9B,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,SAAS,CAACE,YAAY,kBAAkBC,MAAM,CAAC,SAAWP,EAAImC,aAAaX,GAAG,CAAC,MAAQ,SAASC,GAAgC,OAAxBA,EAAOC,iBAAwB1B,EAAIoC,iBAAiB,CAACpC,EAAIQ,GAAG,wBAAwBJ,EAAG,KAAK,CAACE,YAAY,uBAAuBF,EAAG,SAAS,CAACE,YAAY,aAAa,CAACN,EAAIqC,GAAG,GAAGjC,EAAG,IAAI,CAACJ,EAAIQ,GAAG,wBAAwBJ,EAAG,IAAI,CAACA,EAAG,cAAc,CAACG,MAAM,CAAC,GAAK,CAAEK,KAAM,aAAc,CAACZ,EAAIQ,GAAG,cAAc,UACn2D8B,EAAkB,CAAC,WAAa,IAAItC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,IAAI,CAACE,YAAY,eAAe,CAACF,EAAG,IAAI,CAACG,MAAM,CAAC,KAAO,MAAM,CAACP,EAAIQ,GAAG,qB,yDCuElL,GACEI,KAAM,OACN2B,SAAU,CACRjB,KADJ,WAEM,OAAOrB,KAAKuC,OAAOC,MAAMnB,OAG7BoB,KAPF,WAQI,MAAO,CACLnB,MAAOtB,KAAK0C,OAAOC,OAAOrB,MAC1Bb,SAAU,KACVmC,OAAQ,KACRC,SAAU,GACVb,WAAY,KACZE,YAAa,OAGjBY,QAAS,CACP,YADJ,WACA,wKACA,iCACA,gBACA,SACA,mBACA,oBACA,wBANA,OASA,kBATA,8CAWI,WAZJ,WAYA,wJACA,qCACA,iBAEA,iBAJA,8CAOI,QAnBJ,SAmBA,+KACA,oCACA,gBACA,SACA,QACA,SACA,eANA,8CAUI3B,iBA7BJ,SA6BA,GACM,OAAO,IAAb,mBAGE,QAlDF,WAkDA,oLACA,OACA,oBACA,4BACA,MAJA,UACA,EADA,QAKA,QALA,gBAMA,gBACA,kBAPA,8BAUA,wCACA,GACA,qBACA,qBACA,aACA,QACA,mBACA,YAjBA,UAmBA,OACA,oBACA,0DACA,MAtBA,WAmBA,EAnBA,QAuBA,QAvBA,kCAwBA,uCACA,eAzBA,QA2BA,kBA3BA,wBA6BA,sBA7BA,QA+BA,2CACA,0BACA,gCAEA,iBAnCA,gDC1H2Z,I,wBCQvZ4B,EAAY,eACd,EACAjD,EACAuC,GACA,EACA,KACA,WACA,MAIa,aAAAU,E","file":"js/chunk-6d826c96.71acfeab.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=style&index=0&id=98bf031a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=style&index=0&id=98bf031a&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',[_c('div',{staticClass:\"jumbotron\"},[_c('h1',{attrs:{\"align\":\"center\"}},[_vm._v(\"Chat with \"+_vm._s(_vm.chatWith))]),_c('div',{directives:[{name:\"chat-scroll\",rawName:\"v-chat-scroll\"}],staticClass:\"my-3 p-3 bg-white rounded shadow-sm scroll\"},[_c('div',{staticClass:\"media text pt-3\"},[_c('div',_vm._l((_vm.messages),function(message){return _c('div',{key:message.id,staticClass:\"media-body pb-3 mb-0 lh-125\"},[_c('span',[_vm._v(_vm._s(message.value))]),_c('span',{staticClass:\"text-muted\"},[_vm._v(_vm._s(message.sender)+\", \"+_vm._s(_vm.makeTimeReadable(message.timestamp)))]),(_vm.user.uname == message.sender)?_c('a',{staticClass:\"btn text-right text-muted\",on:{\"click\":function($event){$event.preventDefault();return _vm.delChat(message.value, message.sender, message.timestamp)}}},[_vm._v(\"Delete\")]):_vm._e()])}),0)])]),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-12\"},[_c('form',[_c('div',{staticClass:\"input-group add-on\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.newMessage),expression:\"newMessage\"}],staticClass:\"form-control mr-1\",attrs:{\"type\":\"text\",\"id\":\"newMessage\",\"placeholder\":\"Send a message...\"},domProps:{\"value\":(_vm.newMessage)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.newMessage=$event.target.value},function($event){return _vm.checkInput()}]}}),_c('div',{staticClass:\"input-group-btn\"},[_c('button',{staticClass:\"btn btn-primary\",attrs:{\"disabled\":_vm.disableSend},on:{\"click\":function($event){$event.preventDefault();return _vm.sendMessage()}}},[_vm._v(\" Send \")])])])])])])]),_c('hr',{staticClass:\"featurette-divider\"}),_c('footer',{staticClass:\"container\"},[_vm._m(0),_c('p',[_vm._v(\" © 2020 BU Spark! · \"),_c('a',[_c('router-link',{attrs:{\"to\":{ name: 'privacy' }}},[_vm._v(\"Privacy\")])],1)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',{staticClass:\"float-right\"},[_c('a',{attrs:{\"href\":\"#\"}},[_vm._v(\"Back to top\")])])}]\n\nexport { render, staticRenderFns }","<template>\n  <main>\n    <div class=\"jumbotron\">\n      <h1 align=\"center\">Chat with {{ chatWith }}</h1>\n      <div class=\"my-3 p-3 bg-white rounded shadow-sm scroll\" v-chat-scroll>\n        <div class=\"media text pt-3\">\n          <div>\n            <div\n              class=\"media-body pb-3 mb-0 lh-125\"\n              v-for=\"message in messages\"\n              :key=\"message.id\"\n            >\n              <span>{{ message.value }}</span>\n              <span class=\"text-muted\"\n                >{{ message.sender }},\n                {{ makeTimeReadable(message.timestamp) }}</span\n              >\n              <a\n                v-if=\"user.uname == message.sender\"\n                class=\"btn text-right text-muted\"\n                @click.prevent=\"\n                  delChat(message.value, message.sender, message.timestamp)\n                \"\n                >Delete</a\n              >\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-12\">\n          <form>\n            <div class=\"input-group add-on\">\n              <input\n                type=\"text\"\n                class=\"form-control mr-1\"\n                id=\"newMessage\"\n                placeholder=\"Send a message...\"\n                v-model=\"newMessage\"\n                @input=\"checkInput()\"\n              />\n              <div class=\"input-group-btn\">\n                <button\n                  :disabled=\"disableSend\"\n                  class=\"btn btn-primary\"\n                  @click.prevent=\"sendMessage()\"\n                >\n                  Send\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n    <hr class=\"featurette-divider\" />\n\n    <footer class=\"container\">\n      <p class=\"float-right\"><a href=\"#\">Back to top</a></p>\n      <p>\n        © 2020 BU Spark! ·\n        <a>\n          <router-link :to=\"{ name: 'privacy' }\">Privacy</router-link>\n        </a>\n      </p>\n    </footer>\n  </main>\n</template>\n\n<script>\nimport moment from \"moment\";\nimport { db, functions } from \"@/firebase/init.js\";\nexport default {\n  name: \"chat\",\n  computed: {\n    user() {\n      return this.$store.state.user;\n    }\n  },\n  data() {\n    return {\n      uname: this.$route.params.uname,\n      chatWith: null,\n      chatID: null,\n      messages: [],\n      newMessage: null,\n      disableSend: null\n    };\n  },\n  methods: {\n    async sendMessage() {\n      await functions.httpsCallable(\"addChat\")({\n        chatID: this.chatID,\n        message: {\n          value: this.newMessage,\n          sender: this.user.uname,\n          timestamp: Date.now()\n        }\n      });\n      this.newMessage = null;\n    },\n    async checkInput() {\n      if (this.newMessage == null || this.newMessage == \"\") {\n        this.disableSend = true;\n      } else {\n        this.disableSend = false;\n      }\n    },\n    async delChat(value, sender, timestamp) {\n      await functions.httpsCallable(\"deleteChat\")({\n        chatID: this.chatID,\n        message: {\n          value: value,\n          sender: sender,\n          timestamp: timestamp\n        }\n      });\n    },\n    makeTimeReadable(timestamp) {\n      return moment(timestamp).format(\"lll\");\n    }\n  },\n  async created() {\n    let findUser = await db\n      .collection(\"users\")\n      .where(\"uname\", \"==\", this.uname)\n      .get();\n    if (findUser.empty) {\n      this.$router.push({\n        name: \"allchats\"\n      });\n    } else {\n      this.chatWith = findUser.docs[0].data().displayName;\n      let chatRoomID = [\n        this.uname + this.user.uname,\n        this.user.uname + this.uname,\n        this.user.uname,\n        this.uname,\n        this.user.displayName,\n        this.chatWith\n      ];\n      let findChat = await db\n        .collection(\"chats\")\n        .where(\"chatRoomID\", \"array-contains\", this.user.uname + this.uname)\n        .get();\n      if (findChat.empty) {\n        await functions.httpsCallable(\"createChatBox\")({\n          chatRoomID: chatRoomID\n        });\n        location.reload();\n      } else {\n        this.chatID = findChat.docs[0].id;\n      }\n      const msgref = db.collection(\"chats\").doc(this.chatID);\n      msgref.onSnapshot(docSnapshot => {\n        this.messages = docSnapshot.data().messages;\n      });\n      this.disableSend = true;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.container {\n  padding-top: 40px;\n  padding-bottom: 40px;\n}\n\n.material-icons.green {\n  color: green;\n}\n\n.material-icons.red {\n  color: red;\n}\n\n.availability {\n  padding-top: 6px;\n  padding-left: 3px;\n}\n\n.section-head {\n  padding-left: 8px;\n}\n\n.content {\n  padding-left: 12px;\n}\n\n.green {\n  color: green;\n}\n\n.red {\n  color: red;\n}\n\n.scroll {\n  position: relative;\n  z-index: 10;\n  max-height: 400px;\n  overflow-y: scroll;\n}\n\n.add-on .input-group-btn > .btn {\n  border-left-width: 0;\n  left: -2px;\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n}\n\n.add-on .form-control:focus {\n  box-shadow: none;\n  -webkit-box-shadow: none;\n  border-color: #cccccc;\n}\n\n.text-muted {\n  display: block;\n  font-size: 0.8rem;\n}\n\n.material-icons.md-18 {\n  font-size: 18px;\n}\n\n.material-icons.md-24 {\n  font-size: 24px;\n}\n\n.material-icons.md-36 {\n  font-size: 36px;\n}\n\n.material-icons.md-48 {\n  font-size: 48px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./chat.vue?vue&type=template&id=98bf031a&scoped=true&\"\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&id=98bf031a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"98bf031a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}